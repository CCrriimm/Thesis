<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Tom's Admin - Add Menu</title>
    <link href="Bootstrap/Content/bootstrap.min.css" rel="stylesheet" />
    <script src="Bootstrap/Scripts/bootstrap.bundle.min.js"></script>
    <script src="Bootstrap/Scripts/bootstrap.min.js"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    ></script>
</head>

<body class="p-4">
    <div class="container">
        <h2>Admin Panel: Add Menu Items</h2>

        <div class="card p-3 mb-4 bg-light">
            <div class="row g-2">
                <div class="col-md-4">
                    <input type="text" id="itemName" class="form-control" placeholder="Item Name (e.g., 1pc Chicken)">
                </div>
                <div class="col-md-3">
                    <input type="number" id="itemPrice" class="form-control" placeholder="Price (e.g., 99)">
                </div>
                <div class="col-md-3">
                    <select id="itemCategory" class="form-select">
                        <option value="meal">Meal</option>
                        <option value="refill">Refill Item</option>
                        <option value="drink">Drink</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button onclick="addItem()" class="btn btn-primary w-100">Add Item</button>
                </div>
            </div>
        </div>

        <h4>Current Menu in Database:</h4>
        <ul id="menuList" class="list-group">
        </ul>
    </div>

    <script type="module">
        import { db, ref, push, onValue } from "./JS/firebase-config.js";

        window.addItem = function () {
            const name = document.getElementById("itemName").value;
            const price = document.getElementById("itemPrice").value;
            const cat = document.getElementById("itemCategory").value;

            if (name && price) {
                push(ref(db, 'menu_items'), {
                    name: name,
                    price: price,
                    category: cat
                });
                alert("Saved to Database!");
                document.getElementById("itemName").value = "";
            }
        }

        // Function to Read Items (Listen to Firebase) runs automatically whenever you (or anyone else) adds an item 
        const menuRef = ref(db, 'menu_items');
        onValue(menuRef, (snapshot) => {
            const list = document.getElementById("menuList");
            list.innerHTML = "";

            snapshot.forEach((child) => {
                const item = child.val();
                list.innerHTML += `
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        ${item.name} (${item.category})
                        <span class="badge bg-success rounded-pill">â‚±${item.price}</span>
                    </li>
                `;
            });
        });
    </script>
</body>

</html>